<?xml version="1.0" encoding="utf-8" ?>
<ContentPage xmlns="http://schemas.microsoft.com/dotnet/2021/maui"
             xmlns:x="http://schemas.microsoft.com/winfx/2009/xaml"
             xmlns:viewmodels="clr-namespace:BloodPressureTracker.ViewModels"
             x:Class="BloodPressureTracker.Views.AddRecordPage"
             x:DataType="viewmodels:AddRecordViewModel"
             Title="{Binding Title}">

    <ContentPage.Resources>
        <ResourceDictionary>
            <Style x:Key="InputFrame" TargetType="Frame">
                <Setter Property="Padding" Value="15"/>
                <Setter Property="CornerRadius" Value="8"/>
                <Setter Property="BackgroundColor" Value="{AppThemeBinding Light=#F5F5F5, Dark=#2A2A2A}"/>
                <Setter Property="BorderColor" Value="{AppThemeBinding Light=#E0E0E0, Dark=#404040}"/>
            </Style>

            <Style x:Key="TimeSlotHeader" TargetType="Label">
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="FontAttributes" Value="Bold"/>
                <Setter Property="Margin" Value="0,10,0,5"/>
            </Style>

            <Style x:Key="InputLabel" TargetType="Label">
                <Setter Property="FontSize" Value="14"/>
                <Setter Property="VerticalOptions" Value="Center"/>
                <Setter Property="WidthRequest" Value="80"/>
            </Style>

            <Style x:Key="NumberEntry" TargetType="Entry">
                <Setter Property="Keyboard" Value="Numeric"/>
                <Setter Property="FontSize" Value="16"/>
                <Setter Property="Placeholder" Value="--"/>
                <Setter Property="HorizontalTextAlignment" Value="Center"/>
                <Setter Property="WidthRequest" Value="60"/>
            </Style>
        </ResourceDictionary>
    </ContentPage.Resources>

    <ContentPage.ToolbarItems>
        <ToolbarItem Text="������" Command="{Binding CancelCommand}"/>
        <ToolbarItem Text="���������" Command="{Binding SaveCommand}"/>
    </ContentPage.ToolbarItems>

    <ScrollView>
        <VerticalStackLayout Spacing="15" Padding="20">

            <!-- ����� ���� -->
            <Frame Style="{StaticResource InputFrame}">
                <VerticalStackLayout Spacing="10">
                    <Label Text="���� ���������" Style="{StaticResource TimeSlotHeader}"/>

                    <DatePicker Date="{Binding SelectedDate}"
                                Format="dd.MM.yyyy"
                                FontSize="16"/>
                </VerticalStackLayout>
            </Frame>

            <!-- �������� ��������� -->
            <Frame Style="{StaticResource InputFrame}">
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout>
                        <Label Text="�������� ���������" Style="{StaticResource TimeSlotHeader}"/>
                        <Button Text="��������" 
                                Command="{Binding ClearMorningCommand}"
                                BackgroundColor="Transparent"
                                TextColor="{StaticResource DangerColor}"
                                HorizontalOptions="EndAndExpand"/>
                    </HorizontalStackLayout>

                    <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,*" 
                          RowDefinitions="Auto,Auto,Auto"
                          ColumnSpacing="10" RowSpacing="15">

                        <!-- ������� �������� -->
                        <Label Text="�������:" Grid.Column="0" Grid.Row="0" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding MorningSystolic}" Grid.Column="1" Grid.Row="0"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="�� ��.��." Grid.Column="2" Grid.Row="0"
                               FontSize="12" VerticalOptions="Center"/>

                        <!-- ������ �������� -->
                        <Label Text="������:" Grid.Column="3" Grid.Row="0" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding MorningDiastolic}" Grid.Column="4" Grid.Row="0"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="�� ��.��." Grid.Column="5" Grid.Row="0"
                               FontSize="12" VerticalOptions="Center"/>

                        <!-- ����� -->
                        <Label Text="�����:" Grid.Column="0" Grid.Row="1" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding MorningPulse}" Grid.Column="1" Grid.Row="1"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="��/���" Grid.Column="2" Grid.Row="1"
                               FontSize="12" VerticalOptions="Center"/>

                        <!-- ������ ��������� -->
                        <Label Text="{Binding MorningValidationStatus}"
                               Grid.Column="3" Grid.ColumnSpan="3" Grid.Row="1"
                               FontSize="12" TextColor="{Binding MorningValidationColor}"/>

                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- ��������� ��������� -->
            <Frame Style="{StaticResource InputFrame}">
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout>
                        <Label Text="��������� ���������" Style="{StaticResource TimeSlotHeader}"/>
                        <Button Text="��������" 
                                Command="{Binding ClearAfternoonCommand}"
                                BackgroundColor="Transparent"
                                TextColor="{StaticResource DangerColor}"
                                HorizontalOptions="EndAndExpand"/>
                    </HorizontalStackLayout>

                    <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,*" 
                          RowDefinitions="Auto,Auto,Auto"
                          ColumnSpacing="10" RowSpacing="15">

                        <Label Text="�������:" Grid.Column="0" Grid.Row="0" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding AfternoonSystolic}" Grid.Column="1" Grid.Row="0"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="�� ��.��." Grid.Column="2" Grid.Row="0"
                               FontSize="12" VerticalOptions="Center"/>

                        <Label Text="������:" Grid.Column="3" Grid.Row="0" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding AfternoonDiastolic}" Grid.Column="4" Grid.Row="0"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="�� ��.��." Grid.Column="5" Grid.Row="0"
                               FontSize="12" VerticalOptions="Center"/>

                        <Label Text="�����:" Grid.Column="0" Grid.Row="1" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding AfternoonPulse}" Grid.Column="1" Grid.Row="1"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="��/���" Grid.Column="2" Grid.Row="1"
                               FontSize="12" VerticalOptions="Center"/>

                        <Label Text="{Binding AfternoonValidationStatus}"
                               Grid.Column="3" Grid.ColumnSpan="3" Grid.Row="1"
                               FontSize="12" TextColor="{Binding AfternoonValidationColor}"/>

                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- �������� ��������� -->
            <Frame Style="{StaticResource InputFrame}">
                <VerticalStackLayout Spacing="10">
                    <HorizontalStackLayout>
                        <Label Text="�������� ���������" Style="{StaticResource TimeSlotHeader}"/>
                        <Button Text="��������" 
                                Command="{Binding ClearEveningCommand}"
                                BackgroundColor="Transparent"
                                TextColor="{StaticResource DangerColor}"
                                HorizontalOptions="EndAndExpand"/>
                    </HorizontalStackLayout>

                    <Grid ColumnDefinitions="Auto,*,Auto,*,Auto,*" 
                          RowDefinitions="Auto,Auto,Auto"
                          ColumnSpacing="10" RowSpacing="15">

                        <Label Text="�������:" Grid.Column="0" Grid.Row="0" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding EveningSystolic}" Grid.Column="1" Grid.Row="0"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="�� ��.��." Grid.Column="2" Grid.Row="0"
                               FontSize="12" VerticalOptions="Center"/>

                        <Label Text="������:" Grid.Column="3" Grid.Row="0" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding EveningDiastolic}" Grid.Column="4" Grid.Row="0"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="�� ��.��." Grid.Column="5" Grid.Row="0"
                               FontSize="12" VerticalOptions="Center"/>

                        <Label Text="�����:" Grid.Column="0" Grid.Row="1" 
                               Style="{StaticResource InputLabel}"/>
                        <Entry Text="{Binding EveningPulse}" Grid.Column="1" Grid.Row="1"
                               Style="{StaticResource NumberEntry}"/>
                        <Label Text="��/���" Grid.Column="2" Grid.Row="1"
                               FontSize="12" VerticalOptions="Center"/>

                        <Label Text="{Binding EveningValidationStatus}"
                               Grid.Column="3" Grid.ColumnSpan="3" Grid.Row="1"
                               FontSize="12" TextColor="{Binding EveningValidationColor}"/>

                    </Grid>
                </VerticalStackLayout>
            </Frame>

            <!-- ������� -->
            <Frame Style="{StaticResource InputFrame}">
                <VerticalStackLayout Spacing="10">
                    <Label Text="�������" Style="{StaticResource TimeSlotHeader}"/>

                    <Editor Text="{Binding Notes}"
                            AutoSize="TextChanges"
                            MinimumHeightRequest="80"
                            Placeholder="�������������� �������..."
                            FontSize="14"/>
                </VerticalStackLayout>
            </Frame>

            <!-- ������ �������� -->
            <Grid ColumnDefinitions="*,*" ColumnSpacing="10">
                <Button Grid.Column="0" 
                        Text="������" 
                        Command="{Binding CancelCommand}"
                        Style="{StaticResource SecondaryButton}"/>

                <Button Grid.Column="1" 
                        Text="���������" 
                        Command="{Binding SaveCommand}"
                        Style="{StaticResource PrimaryButton}"/>
            </Grid>

        </VerticalStackLayout>
    </ScrollView>

</ContentPage>